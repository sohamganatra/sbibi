deposits
deposits
with deposits as  (select desc1 description,  sum(nvl(acct1, 0)) no_acs__1, sum(nvl(out1, 0)) outs__1,  sum(nvl(acct2, 0)) no_acs__2, sum(nvl(out2, 0)) outs__2,  sum(nvl(acct3, 0)) no_acs__3, sum(nvl(out3, 0)) outs__3,  sum(nvl(acct4, 0)) no_acs__4, sum(nvl(out4, 0)) outs__4,  sum(nvl(acct5, 0)) no_acs__5, sum(nvl(out5, 0)) outs__5,  sum(nvl(acct6, 0)) no_acs__6, sum(nvl(out6, 0)) outs__6,  sum(nvl(acct7, 0)) no_acs__7, sum(nvl(out7, 0)) outs__7,  sum(nvl(acct8, 0)) no_acs__8, sum(nvl(out8, 0)) outs__8,  sum(nvl(acct9, 0)) no_acs__9, sum(nvl(out9, 0)) outs__9,  sum(nvl(acct10, 0)) no_acs__10, sum(nvl(out10, 0)) outs__10,  sum(nvl(acct11, 0)) no_acs__11, sum(nvl(out11, 0)) outs__11,  sum(nvl(acct12, 0)) no_acs__12, sum(nvl(out12, 0)) outs__12,  sum(nvl(acct13, 0)) no_acs__13, sum(nvl(out13, 0)) outs__13,  sum(nvl(acct14, 0)) no_acs__14, sum(nvl(out14, 0)) outs__14,  sum(nvl(acct15, 0)) no_acs__15, sum(nvl(out15, 0)) outs__15,  sum(nvl(acct16, 0)) no_acs__16, sum(nvl(out16, 0)) outs__16,  sum(nvl(acct17, 0)) no_acs__17, sum(nvl(out17, 0)) outs__17,  sum(nvl(acct18, 0)) no_acs__18, sum(nvl(out18, 0)) outs__18,  sum(nvl(acct19, 0)) no_acs__19, sum(nvl(out19, 0)) outs__19,  sum(nvl(acct20, 0)) no_acs__20, sum(nvl(out20, 0)) outs__20,  sum(nvl(acct21, 0)) no_acs__21, sum(nvl(out21, 0)) outs__21,  sum(nvl(acct22, 0)) no_acs__22, sum(nvl(out22, 0)) outs__22,  sum(nvl(acct23, 0)) no_acs__23, sum(nvl(out23, 0)) outs__23,  sum(nvl(acct24, 0)) no_acs__24, sum(nvl(out24, 0)) outs__24,  sum(nvl(acct25, 0)) no_acs__25, sum(nvl(out25, 0)) outs__25,  sum(nvl(acct26, 0)) no_acs__26, sum(nvl(out26, 0)) outs__26,  sum(nvl(acct27, 0)) no_acs__27, sum(nvl(out27, 0)) outs__27,  sum(nvl(acct28, 0)) no_acs__28, sum(nvl(out28, 0)) outs__28,  sum(nvl(acct29, 0)) no_acs__29, sum(nvl(out29, 0)) outs__29,  sum(nvl(acct30, 0)) no_acs__30, sum(nvl(out30, 0)) outs__30,  sum(nvl(acct31, 0)) no_acs__31, sum(nvl(out31, 0)) outs__31  from sunrise_dep_summary, sunrise_master, sdf_main  where brcd=sdf_brcd and faccd = code1 and flag = 'FC' $location$ group by crmd_sdf_circlecode, crmd_sdf_modulecode, sdf_regioncode,brcd, faccd, desc1)
with deposits as  (select desc1 description,  sum(nvl(acct_1, 0)) no_acs__3, sum(nvl(out_1, 0)) outs__3,  sum(nvl(acct_2, 0)) no_acs__4, sum(nvl(out_2, 0)) outs__4,  sum(nvl(acct_3, 0)) no_acs__5, sum(nvl(out_3, 0)) outs__5,  sum(nvl(acct_4, 0)) no_acs__6, sum(nvl(out_4, 0)) outs__6,  sum(nvl(acct_5, 0)) no_acs__7, sum(nvl(out_5, 0)) outs__7,  sum(nvl(acct_6, 0)) no_acs__8, sum(nvl(out_6, 0)) outs__8,  sum(nvl(acct_7, 0)) no_acs__9, sum(nvl(out_7, 0)) outs__9,  sum(nvl(acct_8, 0)) no_acs__10, sum(nvl(out_8, 0)) outs__10,  sum(nvl(acct_9, 0)) no_acs__11, sum(nvl(out_9, 0)) outs__11,  sum(nvl(acct_10, 0)) no_acs__12, sum(nvl(out_10, 0)) outs__12,  sum(nvl(acct_11, 0)) no_acs__1, sum(nvl(out_11, 0)) outs__1,  sum(nvl(acct_12, 0)) no_acs__2, sum(nvl(out_12, 0)) outs__2  from sunrise_dep_summary_m15, sunrise_master, sdf_main  where brcd=sdf_brcd and faccd = code1 and flag = 'FC' $location$  group by crmd_sdf_circlecode, crmd_sdf_modulecode,  sdf_regioncode,brcd, faccd, desc1)
with deposit1 as (SELECT * FROM   (select pdep_brcd brcd, (depca_fn(pdep_brcd, pdep_year, pdep_month)+nvl(PDEP_INTBNKCA,0)) totca, (depsb_fn(pdep_brcd, pdep_year, pdep_month)) totsb, (deptd_fn(pdep_brcd, pdep_year, pdep_month)+nvl(PDEP_INTBNKTD,0)+nvl(PDEP_INTBNKSPTD,0)) tottd, (depca_fn(pdep_brcd, pdep_year, pdep_month)+nvl(PDEP_INTBNKCA,0))+(depsb_fn(pdep_brcd, pdep_year, pdep_month))+(deptd_fn(pdep_brcd, pdep_year, pdep_month)+nvl(PDEP_INTBNKTD,0)+nvl(PDEP_INTBNKSPTD,0)) totdep from prep_deposits where pdep_year=$year$ and pdep_month=$month$ ) UNPIVOT (amount FOR description IN (totca AS 'Current', totsb AS 'Savings Bank', tottd AS 'Time Deposits'))), deposits as (select sum(nvl(amount,0)) outs__, null no_acs__, description from deposit1,sdf_main where brcd=sdf_brcd $location$ group by description)
deposit,deposits
current,saving
sum(no_acs__$time$):No_ACs,sum(outs__$time$):Outs